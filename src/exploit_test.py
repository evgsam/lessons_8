import time
from typing import TYPE_CHECKING

if TYPE_CHECKING:
    # Этот код выполняется только для проверки типов
    # Не создает циклических импортов в runtime
    from http_client import HttpClient


def xss_explot_result_print(condition, text):
    if condition in text:
        print("XSS сработал")
    else:
        print("XSS не сработал")
    return None

def exploit_test(client: 'HttpClient', payloads: dict):
    print (f"проверка уязвимости при приписывании пейлоада к url")
    for name, payload in payloads.items():
        print(f"Тест пейлоада {payload}")
        response = client.get_data(f"/{payload}")
        xss_explot_result_print(name, response.text)
   
    print (f"проверка уязвимости при создании сниппета")
    single_payload = payloads["XSS"]
    print(f"Создаю сниппет с содержанием {single_payload}")
    response=client.get_data(f"/newsnippet2?snippet={single_payload}")
    time.sleep(1)
    response = client.get_data(f"/snippets.gtl")
    xss_explot_result_print("XSS", response.text)



   